"use strict";function parseMSLDate(e){var t=e.split(" "),n=new Date,r=t[0].replace(/\D/g,""),i=getMonthFromString(t[1]),o=i<n.getMonth()?n.getFullYear()-1:n.getFullYear(),a=getTimefromMSL(t[2]);return new Date(o,i,r,a[0],a[1],a[2])}function getMonthFromString(e){var t=Date.parse(e+"1, 2017");return isNaN(t)?null:new Date(t).getMonth()}function getTimefromMSL(e){if("noon"==e)return[12,0,0];var t="pm"==e.substring(e.length-2)?12:0,n=e.split(":");return[parseInt(n[0].replace(/\D/g,""))+t,n[1]?n[1].replace(/\D/g,""):0,0]}function timeAgo(e){switch(void 0===e?"undefined":_typeof(e)){case"number":break;case"string":e=+new Date(e);break;case"object":e.constructor===Date&&(e=e.getTime());break;default:e=+new Date}var t=[[60,"seconds",1],[120,"1 minute ago","1 minute from now"],[3600,"minutes",60],[7200,"1 hour ago","1 hour from now"],[86400,"hours",3600],[172800,"Yesterday","Tomorrow"],[604800,"days",86400],[1209600,"Last week","Next week"],[2419200,"weeks",604800],[4838400,"Last month","Next month"],[29030400,"months",2419200],[58060800,"Last year","Next year"],[290304e4,"years",29030400],[580608e4,"Last century","Next century"],[580608e5,"centuries",290304e4]],n=(+new Date-e)/1e3,r="ago",i=1;if(0==n)return"Just now";n<0&&(n=Math.abs(n),r="from now",i=2);for(var o=0,a=void 0;a=t[o++];)if(n<a[0])return"string"==typeof a[2]?a[i]:Math.floor(n/a[2])+" "+a[1]+" "+r;return e}function reformatEvents(e){var t="";e.forEach(function(e){t+='<div class="eventlist-item" data-orgid="'+e.org[0]+'"><a class="eventlist-item__link" href="'+e.link+'"><div class="eventlist-item__image" style="background-image: url('+e.image+')"><div></div></div><div class="eventlist-item__content"><div class="eventlist-item__title">'+e.title+'</div><div class="eventlist-item__lead">'+e.lead+'</div><div class="eventlist-item__meta"><p>happening <time datetime="'+e.date+'" title="'+e.date+'">'+timeAgo(e.date)+"</time></p></div></div></a></div>"}),document.querySelector(".msl_eventlist").innerHTML=t}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};reformatEvents([].slice.call(document.querySelectorAll(".msl_eventlist .event_item")).map(function(e){var t=e.querySelector(".msl_event_name").innerText,n=e.querySelector("dt a").href,r=[e.dataset.mslOrganisationId,e.querySelector(".msl_event_organisation").innerText],i=e.querySelector(".msl_event_image img")?e.querySelector(".msl_event_image img").src.split("?"):[null],o=e.querySelector(".msl_event_description")?e.querySelector(".msl_event_description").innerText:null,a=e.querySelector("msl_event_location")?e.querySelector("msl_event_location").innerText:null,l=e.querySelector("msl_event_brand")?e.querySelector("msl_event_brand").innerText:null,s=parseMSLDate(e.querySelector(".msl_event_time").innerText);return{title:t,link:n,org:r,image:i[0],lead:o,loc:a,brand:l,date:s}}));